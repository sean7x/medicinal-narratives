schema: '2.0'
stages:
  extract_sample:
    cmd: python src/extract_sample.py --input_path data/raw/lewtun-drug-reviews/train.jsonl
      --output_path data/raw/lewtun-drug-reviews/sample_train.csv --fraction 0.2 --stratify_column
      rating
    deps:
    - path: data/raw/lewtun-drug-reviews/train.jsonl
      hash: md5
      md5: 5bfa955b0f63f5c91db7c77ee4d14d95
      size: 97686013
    - path: src/extract_sample.py
      hash: md5
      md5: 538899e58da06b8d898436c7d1058bf8
      size: 1631
    params:
      params.yaml:
        extract_sample:
          fraction: 0.2
          stratify_column: rating
    outs:
    - path: data/raw/lewtun-drug-reviews/sample_train.csv
      hash: md5
      md5: fe6e3f3aa8d697526f0907b3befedf43
      size: 16599199
  preprocess:
    cmd: python src/preprocessing.py --input_path data/raw/lewtun-drug-reviews/sample_train.csv
      --output_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
    deps:
    - path: data/raw/lewtun-drug-reviews/sample_train.csv
      hash: md5
      md5: fe6e3f3aa8d697526f0907b3befedf43
      size: 16599199
    - path: src/preprocessing.py
      hash: md5
      md5: e3d72c7884b2e82c48acbc57cd8a43e1
      size: 1937
    outs:
    - path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      hash: md5
      md5: 94967cda454b25b48b78b082f7b9752d
      size: 27333994
  feature_engineering:
    cmd: python src/feature_engineering.py --input_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      --bow true --tfidf true --word2vec true --vector_size 100 --window 5 --min_count
      1 --epochs 10 --workers -1 --bert true
    deps:
    - path: params.yaml
      hash: md5
      md5: 6857e88fb3b907204eba5f7de79c3eaf
      size: 373
    - path: src/feature_engineering.py
      hash: md5
      md5: 5a8084c97fb76a77a110c4da6e5e6f78
      size: 4163
    params:
      params.yaml:
        feature_engineering:
          input_path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
          bow: true
          tfidf: true
          word2vec:
            enabled: true
            vector_size: 100
            window: 5
            min_count: 1
            epochs: 10
            workers: -1
          bert: true
    outs:
    - path: data/features/bert_embeddings.pkl
      hash: md5
      md5: 660870a3c3f5e5e939c78658c3107ef7
      size: 3782139974
    - path: data/features/bow_corpus.pkl
      hash: md5
      md5: 2a1540722a532ec9f0f84e49d79c9f5a
      size: 7029158
    - path: data/features/dictionary.pkl
      hash: md5
      md5: fd78c4e2538831123cff6f33fba477f1
      size: 1029442
    - path: data/features/tfidf_corpus.pkl
      hash: md5
      md5: f7a0c3f43958c2a45b16ffe83b252cef
      size: 24628593
    - path: data/features/word2vec_model.pkl
      hash: md5
      md5: 32361b10d90cc6598e731f115e8750a6
      size: 32977113
  topic_modeling_bow_tfidf:
    cmd: python src/topic_modeling_bow_tfidf.py --bow_corpus_path data/features/bow_corpus.pkl
      --tfidf_corpus_path data/features/tfidf_corpus.pkl --dictionary_path data/features/dictionary.pkl
      --lda_n_topics 10 --nmf_n_topics 10 --lda_bow_model_path data/models/lda_bow_model.pkl
      --nmf_bow_model_path data/models/nmf_bow_model.pkl --lda_tfidf_model_path data/models/lda_tfidf_model.pkl
      --nmf_tfidf_model_path data/models/nmf_tfidf_model.pkl
    deps:
    - path: params.yaml
      hash: md5
      md5: 6857e88fb3b907204eba5f7de79c3eaf
      size: 373
    - path: src/topic_modeling_bow_tfidf.py
      hash: md5
      md5: d026d35569a943d9b1fb87487101ea73
      size: 4245
    params:
      params.yaml:
        topic_modeling_bow_tfidf:
          lda_n_topics: 10
          nmf_n_topics: 10
    outs:
    - path: data/models/lda_bow_model.pkl
      hash: md5
      md5: 361139f2704c7ad21b17681e23c5c9da
      size: 161564
    - path: data/models/lda_tfidf_model.pkl
      hash: md5
      md5: 7b0933898d318db84ef53f1b054ca7db
      size: 161566
    - path: data/models/nmf_bow_model.pkl
      hash: md5
      md5: dec566e6cbe9e047a0c3b7e793cc6ecf
      size: 7671484
    - path: data/models/nmf_tfidf_model.pkl
      hash: md5
      md5: 457f6acb59e9224af64ef1fe635cf98c
      size: 7671487
