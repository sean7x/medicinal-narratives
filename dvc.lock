schema: '2.0'
stages:
  extract_sample:
    cmd: python src/extract_sample.py --input_path data/raw/lewtun-drug-reviews/train.jsonl
      --output_path data/raw/lewtun-drug-reviews/sample_train.csv
    deps:
    - path: data/raw/lewtun-drug-reviews/train.jsonl
      hash: md5
      md5: 5bfa955b0f63f5c91db7c77ee4d14d95
      size: 97686013
    - path: src/extract_sample.py
      hash: md5
      md5: 5e687b73a5501a0e1e71e15795d30fd5
      size: 1938
    params:
      params.yaml:
        RANDOM_SEED: 42
        extract_sample:
          fraction: 0.2
          stratify_column: rating
    outs:
    - path: data/raw/lewtun-drug-reviews/sample_train.csv
      hash: md5
      md5: 41087367fcf435c6561149e067e13d57
      size: 16631460
  preprocess:
    cmd: python src/preprocessing.py --input_path data/raw/lewtun-drug-reviews/sample_train.csv
      --output_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
    deps:
    - path: data/raw/lewtun-drug-reviews/sample_train.csv
      hash: md5
      md5: fe6e3f3aa8d697526f0907b3befedf43
      size: 16599199
    - path: src/preprocessing.py
      hash: md5
      md5: e3d72c7884b2e82c48acbc57cd8a43e1
      size: 1937
    outs:
    - path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      hash: md5
      md5: 94967cda454b25b48b78b082f7b9752d
      size: 27333994
  feature_engineering:
    cmd: python src/feature_engineering.py --input_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      --bow true --tfidf true --word2vec true --vector_size 100 --window 5 --min_count
      1 --epochs 10 --workers -1 --bert true
    deps:
    - path: src/feature_engineering.py
      hash: md5
      md5: 4438b6e78b5d4d905357bd42c6126444
      size: 4998
    params:
      params.yaml:
        feature_engineering:
          input_path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
          bow: true
          tfidf: true
          word2vec:
            enabled: true
            vector_size: 100
            window: 5
            min_count: 1
            epochs: 10
            workers: -1
          bert: true
    outs:
    - path: data/features/bert_embeddings.pkl
      hash: md5
      md5: 85b994743bdba3e61ddf24be2dc3af22
      size: 3782139974
    - path: data/features/bow_corpus.pkl
      hash: md5
      md5: 2a1540722a532ec9f0f84e49d79c9f5a
      size: 7029158
    - path: data/features/dictionary.pkl
      hash: md5
      md5: 18f0c038234996327e8aea59abf959e1
      size: 1029442
    - path: data/features/tfidf_corpus.pkl
      hash: md5
      md5: f7a0c3f43958c2a45b16ffe83b252cef
      size: 24628593
    - path: data/features/word2vec_model.pkl
      hash: md5
      md5: 1189b51a8d6fa8a987f6d1d48c8a47ba
      size: 32977113
  topic_modeling_bow_tfidf:
    cmd: python src/topic_modeling_bow_tfidf.py --procd_data_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      --bow_corpus_path data/features/bow_corpus.pkl --tfidf_corpus_path data/features/tfidf_corpus.pkl
      --dictionary_path data/features/dictionary.pkl --lda_n_topics 10 --nmf_n_topics
      10 --lda_bow_model_path data/models/lda_bow_model.pkl --nmf_bow_model_path data/models/nmf_bow_model.pkl
      --lda_tfidf_model_path data/models/lda_tfidf_model.pkl --nmf_tfidf_model_path
      data/models/nmf_tfidf_model.pkl
    deps:
    - path: data/features/bert_embeddings.pkl
      hash: md5
      md5: 85b994743bdba3e61ddf24be2dc3af22
      size: 3782139974
    - path: data/features/bow_corpus.pkl
      hash: md5
      md5: 2a1540722a532ec9f0f84e49d79c9f5a
      size: 7029158
    - path: data/features/dictionary.pkl
      hash: md5
      md5: 18f0c038234996327e8aea59abf959e1
      size: 1029442
    - path: data/features/tfidf_corpus.pkl
      hash: md5
      md5: f7a0c3f43958c2a45b16ffe83b252cef
      size: 24628593
    - path: data/features/word2vec_model.pkl
      hash: md5
      md5: 1189b51a8d6fa8a987f6d1d48c8a47ba
      size: 32977113
    - path: src/topic_modeling_bow_tfidf.py
      hash: md5
      md5: 714d383b2b8ed50a42e5f6d4d5721dad
      size: 4799
    params:
      params.yaml:
        topic_modeling_bow_tfidf:
          procd_data_path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
          lda_n_topics: 10
          nmf_n_topics: 10
    outs:
    - path: data/models/lda_bow_model.pkl
      hash: md5
      md5: c37699c5cd12d95c7591beb9f6814fbe
      size: 161565
    - path: data/models/lda_tfidf_model.pkl
      hash: md5
      md5: 1b13c5e36c0a171e1c98bb7a5043aea6
      size: 161566
    - path: data/models/nmf_bow_model.pkl
      hash: md5
      md5: 6d820b09f04ae80ad5072053ba75545b
      size: 7671484
    - path: data/models/nmf_tfidf_model.pkl
      hash: md5
      md5: 5e3229289e31b1daf5da187299a3b256
      size: 7671487
  preprocess_sample_train:
    cmd: python src/preprocessing.py --input_path data/raw/lewtun-drug-reviews/sample_train.csv
      --output_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
    deps:
    - path: data/raw/lewtun-drug-reviews/sample_train.csv
      hash: md5
      md5: 41087367fcf435c6561149e067e13d57
      size: 16631460
    - path: src/preprocessing.py
      hash: md5
      md5: abc60c5f9395e1b5171c2b615e1997a3
      size: 2621
    outs:
    - path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      hash: md5
      md5: 21efdb5a6b5c3171565b43fa25e99f2a
      size: 49576484
  feature_engineering_sample_train:
    cmd: python src/feature_engineering.py --input_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
    deps:
    - path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      hash: md5
      md5: 21efdb5a6b5c3171565b43fa25e99f2a
      size: 49576484
    - path: src/feature_engineering.py
      hash: md5
      md5: 0b9c23856834f9df2b528b94cbc2eefe
      size: 5291
    params:
      params.yaml:
        RANDOM_SEED: 42
        feature_engineering:
          bow: true
          tfidf: true
          word2vec:
            enabled: true
            vector_size: 100
            window: 5
            min_count: 1
            epochs: 10
            sg: 0
          bert: true
    outs:
    - path: data/features/bert_embeddings.pkl
      hash: md5
      md5: 467d9971ee82925a5d5576e6a608cfb5
      size: 8683975606
    - path: data/features/bow_corpus.pkl
      hash: md5
      md5: 3ad4aa008c77a582716381ed13b548d2
      size: 6849111
    - path: data/features/dictionary.pkl
      hash: md5
      md5: 27b1e41fb1faf7b2a4243bdbde7664ea
      size: 745290
    - path: data/features/tfidf_corpus.pkl
      hash: md5
      md5: 80b4eac6059c4554f8925d6ecdc1a3d0
      size: 24056608
    - path: data/features/word2vec_model.pkl
      hash: md5
      md5: 160864aee21246b01b989c390475b83e
      size: 27103923
  topic_modeling_bow_tfidf_sample_train:
    cmd: python src/topic_modeling_bow_tfidf.py --procd_data_path data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      --bow_corpus_path data/features/bow_corpus.pkl --tfidf_corpus_path data/features/tfidf_corpus.pkl
      --dictionary_path data/features/dictionary.pkl --lda_bow_model_path models/lda_bow_model.pkl
      --nmf_bow_model_path models/nmf_bow_model.pkl --lda_tfidf_model_path models/lda_tfidf_model.pkl
      --nmf_tfidf_model_path models/nmf_tfidf_model.pkl
    deps:
    - path: data/features/bert_embeddings.pkl
      hash: md5
      md5: 467d9971ee82925a5d5576e6a608cfb5
      size: 8683975606
    - path: data/features/bow_corpus.pkl
      hash: md5
      md5: 3ad4aa008c77a582716381ed13b548d2
      size: 6849111
    - path: data/features/dictionary.pkl
      hash: md5
      md5: 27b1e41fb1faf7b2a4243bdbde7664ea
      size: 745290
    - path: data/features/tfidf_corpus.pkl
      hash: md5
      md5: 80b4eac6059c4554f8925d6ecdc1a3d0
      size: 24056608
    - path: data/features/word2vec_model.pkl
      hash: md5
      md5: 160864aee21246b01b989c390475b83e
      size: 27103923
    - path: data/preprocessed/lewtun-drug-reviews/procd_sample_train.csv
      hash: md5
      md5: 21efdb5a6b5c3171565b43fa25e99f2a
      size: 49576484
    - path: src/topic_modeling_bow_tfidf.py
      hash: md5
      md5: ac8d3baf123ce1885e53347c5700d4f4
      size: 5276
    params:
      params.yaml:
        RANDOM_SEED: 42
        topic_modeling_bow_tfidf:
          lda_n_topics: 10
          nmf_n_topics: 10
    outs:
    - path: models/lda_bow_model.pkl
      hash: md5
      md5: b0fd8cf268df2c03ac95053b17eb494e
      size: 132633
    - path: models/lda_tfidf_model.pkl
      hash: md5
      md5: 73683afd5c8a857635074f1a80780dfc
      size: 132635
    - path: models/nmf_bow_model.pkl
      hash: md5
      md5: 24f136e8fbab1a7be7881833d24df68f
      size: 6172005
    - path: models/nmf_tfidf_model.pkl
      hash: md5
      md5: 25a7dd835f61be8c280266eff0c6f11a
      size: 6172007
